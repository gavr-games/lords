{"version":3,"sources":["webpack:///webpack/bootstrap 0e8d5428ca98b09ca17e","webpack:///./game/mode/js/mode.js","webpack:///./game/mode/js/unit.js","webpack:///./game/mode/js/building.js","webpack:///./game/mode/js/board_object.js"],"names":["GameMode","Unit","Building","BoardObject","window","id","boardUnitId","units","board_units","toInt","players_by_num","getPlayerNum","ux","uy","board","each","items","index","item","x","y","$chk","nearSelectedUnit","cx","cy","size","getSize","distance","teleport","tx","ty","tid","board_buildings","buildings","my_player_num","a","b","dist","Math","sqrt","mx","my","fitsCoord","flying","unitCoord","getLeftUpCoord","movesLeft","getMovesLeft","abs","canMove","canTeleport","targetX","targetY","isNear","path","getPath","slice","length","canFlyToCoord","not_reached","path_board","Array","i","k","l","m","symbols","knight","target_coord","leftUpCoord","cnear","tnear","step","cango","t_in","x_in","path_moves","x_path","y_path","path_actions","u_x","u_y","cur_x","cur_y","doattack","ufound","stop","delta","j","pow","sina","angl","PI","asin","angl2","can_hit_earlier","undefined","push","boardBuildingId","boardObjectId","object","getTeam"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;;AAEA;;AACA;;AACA;;;;KAEMA,Q,GACJ,oBAAc;AAAA;;AACZ,QAAKC,IAAL,GAAYA,UAAZ;AACA,QAAKC,QAAL,GAAgBA,kBAAhB;AACA,QAAKC,WAAL,GAAmBA,yBAAnB;AACD,E;;AAGHC,QAAOJ,QAAP,GAAkB,IAAIA,QAAJ,EAAlB,C;;;;;;ACdA;;;;;;;;;;KAEaC,I,WAAAA,I;AACX,mBAAYI,EAAZ,EAAgB;AAAA;;AACd,cAAKC,WAAL,GAAmBD,EAAnB;AACD;;;;mCAES;AACR,oBAAOE,MAAMC,YAAY,KAAKF,WAAjB,EAA8B,SAA9B,CAAN,EAAgD,MAAhD,EAAwDG,KAAxD,EAAP;AACD;;;wCAEc;AACb,oBAAOD,YAAY,KAAKF,WAAjB,EAA8B,YAA9B,EAA4CG,KAA5C,EAAP;AACD;;;wCAEc;AACb,oBAAOD,YAAY,KAAKF,WAAjB,EAA8B,YAA9B,CAAP;AACD;;;mCAES;AACR,oBAAOI,eAAe,KAAKC,YAAL,EAAf,EAAoC,MAApC,CAAP;AACD;;;0CAEgB;AACf,iBAAIN,KAAK,KAAKC,WAAd;AACA,iBAAIM,KAAK,OAAT;AACA,iBAAIC,KAAK,OAAT;AACAC,mBAAMC,IAAN,CAAW,UAASC,KAAT,EAAgBC,KAAhB,EAAuB;AAChC,qBAAID,KAAJ,EAAWA,MAAMD,IAAN,CAAW,UAASG,IAAT,EAAeD,KAAf,EAAsB;AAC1C,yBAAIC,IAAJ,EACE,IAAIA,KAAK,KAAL,KAAeb,EAAf,IAAqBa,KAAK,MAAL,KAAgB,MAAzC,EAAiD;AAC/C,6BAAIA,KAAK,GAAL,EAAUT,KAAV,KAAoBG,EAAxB,EAA4BA,KAAKM,KAAK,GAAL,EAAUT,KAAV,EAAL;AAC5B,6BAAIS,KAAK,GAAL,EAAUT,KAAV,KAAoBI,EAAxB,EAA4BA,KAAKK,KAAK,GAAL,EAAUT,KAAV,EAAL;AAC7B;AACJ,kBANU;AAOZ,cARD;AASA,oBAAO,EAACU,GAAGP,EAAJ,EAAQQ,GAAGP,EAAX,EAAP;AACD;;;mCAES;AACR,iBAAIR,KAAK,KAAKC,WAAd;AACA,oBAAOE,YAAYH,EAAZ,EAAgB,YAAhB,EAA8BI,KAA9B,KAAwC,CAAxC,IAA6C,CAACY,KAAKb,YAAYH,EAAZ,EAAgB,UAAhB,CAAL,CAArD;AACD;;;gCAEMc,C,EAAGC,C,EAAG;AACX,iBAAIf,KAAK,KAAKC,WAAd;AACA,iBAAIgB,mBAAmB,KAAvB;AACA,iBAAIC,EAAJ;AACA,iBAAIC,EAAJ;AACA,kBAAKD,KAAKJ,IAAI,CAAd,EAAiBI,KAAKJ,IAAI,CAA1B,EAA6BI,IAA7B;AACE,sBAAKC,KAAKJ,IAAI,CAAd,EAAiBI,KAAKJ,IAAI,CAA1B,EAA6BI,IAA7B,EAAmC;AACjC,yBAAIV,MAAMS,EAAN,CAAJ,EACE,IAAIT,MAAMS,EAAN,EAAUC,EAAV,CAAJ,EACE,IAAIV,MAAMS,EAAN,EAAUC,EAAV,EAAc,KAAd,KAAwBnB,EAAxB,IAA8BS,MAAMS,EAAN,EAAUC,EAAV,EAAc,MAAd,KAAyB,MAA3D,EAAmE;AACjEF,4CAAmB,IAAnB;AACD;AACN;AAPH,cAQA,OAAOA,gBAAP;AACD;;;qCAEWH,C,EAAGC,C,EAAG;AAChB,iBAAIf,KAAK,KAAKC,WAAd;AACA,iBAAImB,OAAO,KAAKC,OAAL,EAAX;AACA,iBAAIC,WAAW,MAAf;AACA,iBAAIC,WAAW,CAAf;AACA,iBAAIC,KAAK,CAAT;AACA,iBAAIC,KAAK,CAAT;AACA,iBAAIC,GAAJ;AACAC,6BAAgBjB,IAAhB,CAAqB,UAASG,IAAT,EAAeD,KAAf,EAAsB;AACzC,qBAAIC,IAAJ,EACE,IAAIG,KAAKX,eAAeQ,KAAK,YAAL,CAAf,CAAL,CAAJ,EAA8C;AAC5C,yBAAIV,YAAYH,EAAZ,EAAgB,gBAAhB,KAAqC,CAArC,IAA0C4B,UAAUf,KAAK,aAAL,CAAV,EAA+B,SAA/B,KAA6C,UAAvF,KAAsGA,KAAK,YAAL,KAAsBgB,aAAtB,IAAuCxB,eAAeQ,KAAK,YAAL,CAAf,EAAmC,MAAnC,KAA8CR,eAAewB,aAAf,EAA8B,MAA9B,CAA3L,CAAJ,EAAuO;AAAE;AACvOH,+BAAMb,KAAK,IAAL,CAAN;AACAU,oCAAW,CAAX;AACA;AACAd,+BAAMC,IAAN,CAAW,UAASC,KAAT,EAAgBC,KAAhB,EAAuB;AAChC,iCAAID,KAAJ,EAAWA,MAAMD,IAAN,CAAW,UAASG,IAAT,EAAeD,KAAf,EAAsB;AAC1C,qCAAIC,IAAJ,EACE,IAAIA,KAAK,KAAL,KAAea,GAAf,IAAsBb,KAAK,MAAL,KAAgB,UAA1C,EAAsD;AACpD,yCAAIiB,IAAIhB,IAAID,KAAK,GAAL,EAAUT,KAAV,EAAZ;AACA,yCAAI2B,IAAIhB,IAAIF,KAAK,GAAL,EAAUT,KAAV,EAAZ;AACA,yCAAI4B,OAAOC,KAAKC,IAAL,CAAUJ,IAAEA,CAAF,GAAMC,IAAEA,CAAlB,CAAX;AACA,yCAAIC,OAAOV,QAAX,EAAqB;AAAE;AACrBA,oDAAWU,IAAX;AACAR,8CAAKX,KAAK,GAAL,EAAUT,KAAV,EAAL;AACAqB,8CAAKZ,KAAK,GAAL,EAAUT,KAAV,EAAL;AACD;AACF;AACJ,8BAZU;AAaZ,0BAdD;AAeD;AACN,cAvBD;AAwBA,oBAAQU,KAAKU,KAAKJ,IAAV,IAAkBN,KAAKU,KAAK,CAA7B,IAAoCT,KAAKU,KAAKL,IAAV,IAAkBL,KAAKU,KAAK,CAAhE,IAAsEF,YAAY,CAAzF;AACD;;;mCAEST,C,EAAGC,C,EAAG;AACd,iBAAIoB,WAAJ;AAAA,iBAAQC,WAAR;AACA,iBAAIpC,KAAK,KAAKC,WAAd;AACA,iBAAImB,OAAO,KAAKC,OAAL,EAAX;AACA,kBAAKc,KAAKrB,CAAV,EAAaqB,KAAKrB,IAAIM,IAAtB,EAA4Be,IAA5B;AACE,sBAAKC,KAAKrB,CAAV,EAAaqB,KAAKrB,IAAIK,IAAtB,EAA4BgB,IAA5B,EAAkC;AAChC,yBAAI3B,MAAM0B,EAAN,CAAJ,EACE,IAAI1B,MAAM0B,EAAN,EAAUC,EAAV,CAAJ,EACE,IAAI3B,MAAM0B,EAAN,EAAUC,EAAV,EAAc,KAAd,CAAJ,EACE,IAAI3B,MAAM0B,EAAN,EAAUC,EAAV,EAAc,MAAd,KAAyB,MAAzB,IAAmC3B,MAAM0B,EAAN,EAAUC,EAAV,EAAc,KAAd,KAAwBpC,EAA/D,EAAmE,OAAO,KAAP;AACzE,yBAAImC,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqBC,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EAA4C,OAAO,KAAP;AAC7C;AAPH,cAQA,OAAO,IAAP;AACD;;;uCAEatB,C,EAAGC,C,EAAG;AAClB,iBAAI,CAAC,KAAKsB,SAAL,CAAevB,CAAf,EAAkBC,CAAlB,CAAL,EAA2B;AACzB,wBAAO,KAAP;AACD;AACD,iBAAIZ,YAAY,KAAKF,WAAjB,EAA8BqC,MAA9B,IAAwC,CAA5C,EAA+C;AAC7C,wBAAO,KAAP;AACD;;AAED;AACA,iBAAIC,YAAY,KAAKC,cAAL,EAAhB;AACA,iBAAIC,YAAY,KAAKC,YAAL,EAAhB;AACA,iBAAIT,KAAKU,GAAL,CAASJ,UAAUzB,CAAV,GAAcA,CAAvB,IAA4B2B,SAA5B,IAAyCR,KAAKU,GAAL,CAASJ,UAAUxB,CAAV,GAAcA,CAAvB,IAA4B0B,SAAzE,EAAoF;AAClF,wBAAO,KAAP;AACD;;AAED,oBAAO,IAAP;AACD;;;qCAEW3B,C,EAAGC,C,EAAG;AAChB;AACA,iBAAI,CAAC,KAAK6B,OAAL,EAAL,EAAqB;AACnB,wBAAO,EAAP;AACD;;AAED;AACA,iBAAI,KAAKC,WAAL,CAAiB/B,CAAjB,EAAoBC,CAApB,KAA0B,KAAKsB,SAAL,CAAevB,CAAf,EAAkBC,CAAlB,CAA9B,EAAoD;AAClD,wBAAO,CAAC;AACN,0BAAKD,CADC;AAEN,0BAAKC,CAFC;AAGN,+BAAU;AAHJ,kBAAD,CAAP;AAKD;;AAED,iBAAI+B,UAAUhC,CAAd;AACA,iBAAIiC,UAAUhC,CAAd;AACA;AACA,iBAAIR,KAAK,KAAKiC,cAAL,GAAsB1B,CAA/B;AACA,iBAAIN,KAAK,KAAKgC,cAAL,GAAsBzB,CAA/B;AACA,iBAAI,KAAKiC,MAAL,CAAYlC,CAAZ,EAAeC,CAAf,KAAqB,KAAKM,OAAL,KAAiB,CAA1C,EAA6C;AAC3C,qBAAIP,IAAIP,EAAR,EAAY;AACVuC,+BAAUhC,CAAV;AACD,kBAFD,MAEO,IAAIA,IAAKP,KAAK,KAAKc,OAAL,EAAL,GAAsB,CAA/B,EAAmC;AACxCyB,+BAAUhC,IAAI,KAAKO,OAAL,EAAJ,GAAqB,CAA/B;AACD,kBAFM,MAEA;AACLyB,+BAAUvC,EAAV;AACD;AACD,qBAAIQ,IAAIP,EAAR,EAAY;AACVuC,+BAAUhC,CAAV;AACD,kBAFD,MAEO,IAAIA,IAAKP,KAAK,KAAKa,OAAL,EAAL,GAAsB,CAA/B,EAAmC;AACxC0B,+BAAUhC,IAAI,KAAKM,OAAL,EAAJ,GAAqB,CAA/B;AACD,kBAFM,MAEA;AACL0B,+BAAUvC,EAAV;AACD;AACF;;AAED;AACA,iBAAIyC,OAAO,KAAKC,OAAL,CAAaJ,OAAb,EAAsBC,OAAtB,EAA+BI,KAA/B,CAAqC,CAArC,EAAwC,KAAKT,YAAL,EAAxC,CAAX;;AAEA;AACA,iBAAIO,KAAKG,MAAL,IAAe,CAAf,IAAoB,KAAKC,aAAL,CAAmBP,OAAnB,EAA4BC,OAA5B,CAAxB,EAA8D;AAC5D,wBAAO,CAAC;AACN,0BAAKD,OADC;AAEN,0BAAKC,OAFC;AAGN,+BAAU;AAHJ,kBAAD,CAAP;AAKD;;AAED,oBAAOE,IAAP;AACD;;;iCAEOnC,C,EAAGC,C,EAAG;AACZ,iBAAIkC,OAAO,EAAX;AACA,iBAAIK,cAAc,IAAlB;AACA,iBAAIC,aAAa,IAAIC,KAAJ,EAAjB;AACA,iBAAIC,IAAI,CAAR;AACA,iBAAIC,IAAI,CAAR;AACA,iBAAIC,IAAI,CAAR;AACA,iBAAIC,IAAI,CAAR;AACA,iBAAIC,UAAU,IAAIL,KAAJ,CAAU,GAAV,EAAe,GAAf,EAAoB,GAApB,EAAyB,GAAzB,EAA8B,GAA9B,EAAmC,GAAnC,EAAwC,GAAxC,EAA6C,GAA7C,EAAkD,GAAlD,EAAuD,GAAvD,EAA4D,GAA5D,EAAiE,GAAjE,EAAsE,GAAtE,EAA2E,GAA3E,EAAgF,GAAhF,EAAqF,GAArF,EAA0F,GAA1F,EAA+F,GAA/F,EAAoG,GAApG,EAAyG,GAAzG,CAAd;AACA,iBAAIxD,KAAK,KAAKC,WAAd;AACA,iBAAImB,OAAOlB,MAAMC,YAAYH,EAAZ,EAAgB,SAAhB,CAAN,EAAkC,MAAlC,EAA0CI,KAA1C,EAAX;AACA,iBAAI0D,SAAS3D,YAAYH,EAAZ,EAAgB,QAAhB,CAAb;AACA;AACA,kBAAKyD,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB,EAAyB;AACrBF,4BAAWE,CAAX,IAAgB,IAAID,KAAJ,EAAhB;AACA,sBAAKE,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB,EAAyB;AACrBH,gCAAWE,CAAX,EAAcC,CAAd,IAAmB,GAAnB;AACH;AACJ;AACD;AACAjD,mBAAMC,IAAN,CAAW,UAASC,KAAT,EAAgBC,KAAhB,EAAuB;AAC9B,qBAAID,KAAJ,EAAWA,MAAMD,IAAN,CAAW,UAASG,IAAT,EAAeD,KAAf,EAAsB;AACxC,yBAAIC,IAAJ,EAAU;AACN,6BAAIA,KAAK,MAAL,KAAgB,MAAhB,IAA0BA,KAAK,KAAL,EAAYT,KAAZ,MAAuBJ,EAArD,EAAwD,CAAxD,CAA0D;AAA1D,8BACK,IAAIa,KAAK,MAAL,KAAgB,UAApB,EAAgC;AACjC0C,4CAAW1C,KAAK,GAAL,EAAUT,KAAV,EAAX,EAA8BS,KAAK,GAAL,EAAUT,KAAV,EAA9B,IAAmD,GAAnD,CADC,KAEA,IAAIS,KAAK,MAAL,KAAgB,MAApB,EAA4B;AAAE;AAC/B;AACA,qCAAI,CAACG,KAAKX,eAAeF,YAAYU,KAAK,KAAL,CAAZ,EAAyB,YAAzB,CAAf,CAAL,CAAL,EAAmE;AAC/D,4CAAOJ,MAAMI,KAAK,GAAL,EAAUT,KAAV,EAAN,EAAyBS,KAAK,GAAL,EAAUT,KAAV,EAAzB,CAAP;AACA,yCAAIY,KAAKb,YAAYU,KAAK,KAAL,CAAZ,CAAL,CAAJ,EAAoC,OAAOV,YAAYU,KAAK,KAAL,CAAZ,CAAP;AACvC,kCAHD,MAGO,IAAIV,YAAYH,EAAZ,EAAgB,YAAhB,KAAiCG,YAAYU,KAAK,KAAL,CAAZ,EAAyB,YAAzB,CAAjC,IAA2ER,eAAeF,YAAYH,EAAZ,EAAgB,YAAhB,CAAf,EAA8C,MAA9C,KAAyDK,eAAeF,YAAYU,KAAK,KAAL,CAAZ,EAAyB,YAAzB,CAAf,EAAuD,MAAvD,CAAxI,EAAwM0C,WAAW1C,KAAK,GAAL,EAAUT,KAAV,EAAX,EAA8BS,KAAK,GAAL,EAAUT,KAAV,EAA9B,IAAmD,GAAnD,CAAxM,KACFmD,WAAW1C,KAAK,GAAL,EAAUT,KAAV,EAAX,EAA8BS,KAAK,GAAL,EAAUT,KAAV,EAA9B,IAAmD,GAAnD;AACR,8BAPI,MAOE;AAAE;AACL,qCAAIY,KAAKX,eAAesB,gBAAgBd,KAAK,KAAL,CAAhB,EAA6B,YAA7B,CAAf,CAAL,CAAJ,EAAsE;AAAE;AACpE,yCAAIV,YAAYH,EAAZ,EAAgB,YAAhB,KAAiC2B,gBAAgBd,KAAK,KAAL,CAAhB,EAA6B,YAA7B,CAAjC,IAA+ER,eAAeF,YAAYH,EAAZ,EAAgB,YAAhB,CAAf,EAA8C,MAA9C,KAAyDK,eAAesB,gBAAgBd,KAAK,KAAL,CAAhB,EAA6B,YAA7B,CAAf,EAA2D,MAA3D,CAA5I,EAAgN0C,WAAW1C,KAAK,GAAL,EAAUT,KAAV,EAAX,EAA8BS,KAAK,GAAL,EAAUT,KAAV,EAA9B,IAAmD,GAAnD,CAAhN,KACKmD,WAAW1C,KAAK,GAAL,EAAUT,KAAV,EAAX,EAA8BS,KAAK,GAAL,EAAUT,KAAV,EAA9B,IAAmD,GAAnD;AACR,kCAHD,MAIA,IAAIuB,gBAAgBd,KAAK,KAAL,CAAhB,EAA6B,QAA7B,IAAyC,CAA7C,EAAgD;AAC5C0C,gDAAW1C,KAAK,GAAL,EAAUT,KAAV,EAAX,EAA8BS,KAAK,GAAL,EAAUT,KAAV,EAA9B,IAAmD,GAAnD,CADJ,KAGImD,WAAW1C,KAAK,GAAL,EAAUT,KAAV,EAAX,EAA8BS,KAAK,GAAL,EAAUT,KAAV,EAA9B,IAAmD,GAAnD;AACP;AACJ;AACJ,kBAvBU;AAwBd,cAzBD;AA0BA,iBAAI2D,eAAeR,WAAWzC,CAAX,EAAcC,CAAd,CAAnB;AACA,iBAAIwC,WAAWzC,CAAX,EAAcC,CAAd,KAAoB,GAAxB,EAA6BwC,WAAWzC,CAAX,EAAcC,CAAd,IAAmB,GAAnB;AAC7B,iBAAIiD,cAAc,KAAKxB,cAAL,EAAlB;AACA,iBAAIjC,KAAKyD,YAAYlD,CAArB;AACA,iBAAIN,KAAKwD,YAAYjD,CAArB;AACAwC,wBAAWhD,EAAX,EAAeC,EAAf,IAAqB,GAArB;;AAEA,iBAAIyD,QAAQ,KAAZ;AACA,iBAAIC,QAAQ,IAAZ;AACA,iBAAIC,OAAO,CAAX;AACA,iBAAIC,QAAQ,IAAZ;AACA,iBAAIC,OAAO,KAAX;AACA,iBAAIC,OAAO,KAAX;AACA;AACA,oBAAOhB,eAAeY,KAAtB,EAA6B;AACzBA,yBAAQ,KAAR;AACA,sBAAKT,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB;AACI,0BAAKC,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB,EAAyB;AACrBO,iCAAQ,KAAR;AACA,6BAAIV,WAAWE,CAAX,EAAcC,CAAd,KAAoB,GAApB,IAA2BH,WAAWE,CAAX,EAAcC,CAAd,KAAoB,GAAnD,EAAwD;AACpD,iCAAII,MAAJ,EAAY;AACR,sCAAKH,IAAIF,IAAI,CAAb,EAAgBE,IAAIF,IAAI,CAAxB,EAA2BE,GAA3B;AACI,0CAAKC,IAAIF,IAAI,CAAb,EAAgBE,IAAIF,IAAI,CAAxB,EAA2BE,GAA3B,EAAgC;AAC5B,6CAAID,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqBC,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EACI,IAAK3B,KAAKU,GAAL,CAASc,IAAIE,CAAb,KAAmB,CAAnB,IAAwB1B,KAAKU,GAAL,CAASe,IAAIE,CAAb,KAAmB,CAA5C,IAAmD3B,KAAKU,GAAL,CAASc,IAAIE,CAAb,KAAmB,CAAnB,IAAwB1B,KAAKU,GAAL,CAASe,IAAIE,CAAb,KAAmB,CAAlG,EACI,IAAKO,QAAQ,CAAR,IAAaZ,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAAlC,IAA2CO,QAAQ,CAAR,IAAaZ,WAAWI,CAAX,EAAcC,CAAd,KAAoBC,QAAQM,OAAO,CAAf,CAAhF,EACI,IAAI/C,OAAO,CAAX,EAAc;AAAE;AACZ,iDAAI+C,QAAQ,CAAR,IAAaZ,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAArC,EAA0C;AACtC,qDAAID,KAAKpD,EAAL,IAAWqD,KAAKpD,EAApB,EAAwByD,QAAQ,CAAR;AAC3B,8CAFD,MAEOA,QAAQ,CAAR;AACV,0CAJD,MAIOA,QAAQ,CAAR;AACtB;AAVL;AAWH,8BAZD,MAYO;AAAE;AACL,sCAAKN,IAAIF,IAAI,CAAb,EAAgBE,IAAIF,IAAI,CAAxB,EAA2BE,GAA3B;AACI,0CAAKC,IAAIF,IAAI,CAAb,EAAgBE,IAAIF,IAAI,CAAxB,EAA2BE,GAA3B;AACI,6CAAID,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqBC,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EACI,IAAKO,QAAQ,CAAR,IAAaZ,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAAlC,IAA2CO,QAAQ,CAAR,IAAaZ,WAAWI,CAAX,EAAcC,CAAd,KAAoBC,QAAQM,OAAO,CAAf,CAAhF,EAAoGF,QAAQ,CAAR;AAF5G;AADJ;AAIH;AACD,iCAAIA,KAAJ,EAAW;AACP,qCAAIV,WAAWE,CAAX,EAAcC,CAAd,KAAoB,GAAxB,EAA6B;AAAE;AAC3BJ,mDAAc,KAAd;AACH,kCAFD,MAEO;AACHc,6CAAQ,IAAR;AACA,yCAAIhD,OAAO,CAAX,EAAc;AAAE;AACZiD,gDAAO,KAAP;AACAC,gDAAO,KAAP;AACA,8CAAKX,IAAIF,CAAT,EAAYE,IAAIF,IAAIrC,IAApB,EAA0BuC,GAA1B;AACI,kDAAKC,IAAIF,CAAT,EAAYE,IAAIF,IAAItC,IAApB,EAA0BwC,GAA1B,EAA+B;AAC3B,qDAAID,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqBC,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EAA4C;AACxC,yDAAIL,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAAxB,EAA6BU,OAAO,IAAP;AAC7B,yDAAIf,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAAxB,EAA6BS,OAAO,IAAP;AAC7B,yDAAId,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAApB,IAA2BL,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAA/C,IAAsDL,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAA9E,EAAmFQ,QAAQ,KAAR;AACtF,kDAJD,MAIOA,QAAQ,KAAR;AACV;AAPL,0CAHU,CAWV;AACA,6CAAIA,SAAS,KAAb,EAAoB;AAChB,iDAAIpD,KAAKP,MAAMK,CAAN,CAAL,KAAkBE,KAAKP,MAAMK,CAAN,EAASC,CAAT,CAAL,CAAlB,IAAuCC,KAAKP,MAAMK,CAAN,EAASC,CAAT,EAAY,KAAZ,CAAL,CAA3C,EACI,IAAIsD,QAAQ,CAACC,IAAb,EAAmB;AACfF,yDAAQ,IAAR;AACH;AACR;AACJ;AACD,yCAAIA,KAAJ,EAAW;AACPb,oDAAWE,CAAX,EAAcC,CAAd,IAAmBG,QAAQM,IAAR,CAAnB;AACAD,iDAAQ,IAAR;AACH;AACJ;AACJ;AACJ,0BAnDoB,CAmDnB;AACL;AArDL,kBAsDAC;AACH;AACD;AACA;AACA;AACA;AACA;AACAA;AACAI,0BAAaJ,OAAO,CAApB;AACA,iBAAIK,SAAS,EAAb;AACA,iBAAIC,SAAS,EAAb;AACA,iBAAIC,eAAe,EAAnB;AACA,iBAAIC,MAAM,EAAV;AACA,iBAAIC,MAAM,EAAV;AACA,kBAAKnB,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB;AAAyBe,wBAAOf,CAAP,IAAY,CAAC,CAAb;AAAzB,cACA,KAAKA,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB;AAAyBgB,wBAAOhB,CAAP,IAAY,CAAC,CAAb;AAAzB,cACA,IAAIM,gBAAgB,GAApB,EAAyB,OAAO,EAAP,CApIb,CAoIwB;AACpC,kBAAKN,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB;AAAyBiB,8BAAajB,CAAb,IAAkB,GAAlB;AAAzB,cACA,IAAIoB,QAAQ/D,CAAZ;AACA,iBAAIgE,QAAQ/D,CAAZ;AACAyD,oBAAOL,IAAP,IAAeU,KAAf;AACAJ,oBAAON,IAAP,IAAeW,KAAf;AACAV,qBAAQ,IAAR;AACA,iBAAIW,WAAW,KAAf;AACA,iBAAI3D,OAAO,CAAP,IAAY2C,gBAAgB,GAAhC,EAAqC;AAAE;AACnC,sBAAKJ,IAAIa,OAAOL,IAAP,CAAT,EAAuBR,IAAIa,OAAOL,IAAP,IAAe/C,IAA1C,EAAgDuC,GAAhD;AACI,0BAAKC,IAAIa,OAAON,IAAP,CAAT,EAAuBP,IAAIa,OAAON,IAAP,IAAe/C,IAA1C,EAAgDwC,GAAhD;AACI,6BAAID,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqBC,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EAA4C;AACxC,iCAAIL,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAApB,IAA2BL,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAAnD,EAAwDmB,WAAW,IAAX;AACxD,iCAAIxB,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAAxB,EAA6BQ,QAAQ,KAAR;AAChC,0BAHD,MAGOA,QAAQ,KAAR;AAJX;AADJ;AAMH,cAPD,MAOO,IAAIL,gBAAgB,GAAhB,IAAuBA,gBAAgB,GAA3C,EAAgD;AACnDgB,4BAAW,IAAX;AACH;AACD,iBAAK,CAACX,KAAD,IAAU,CAACW,QAAhB,EAA2B;AACvBP,wBAAO,CAAP,IAAY,CAAC,CAAb;AACAC,wBAAO,CAAP,IAAY,CAAC,CAAb;AACA,wBAAO,EAAP;AACH;AACD,iBAAIM,QAAJ,EAAcL,aAAaP,IAAb,IAAqB,GAArB;AACdF,qBAAQ,CAAR;AACA,iBAAIe,SAAS,CAAb;AACA,iBAAIC,OAAO,CAAX;AACA;AACA,gBAAG;AACCN,uBAAM,IAAInB,KAAJ,EAAN;AACAoB,uBAAM,IAAIpB,KAAJ,EAAN;AACAwB,0BAAS,CAAT;AACA,qBAAIE,QAAQ,GAAZ;AACA,qBAAIpB,UAAU,CAAd,EAAiB;AAAE;AACf,0BAAKL,IAAIoB,QAAQ,CAAjB,EAAoBpB,IAAIoB,QAAQ,CAAhC,EAAmCpB,GAAnC;AACI,8BAAK0B,IAAIL,QAAQ,CAAjB,EAAoBK,IAAIL,QAAQ,CAAhC,EAAmCK,GAAnC,EAAwC;AACpC,iCAAI1B,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqB0B,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EACI,IAAKlD,KAAKU,GAAL,CAASkC,QAAQpB,CAAjB,KAAuB,CAAvB,IAA4BxB,KAAKU,GAAL,CAASmC,QAAQK,CAAjB,KAAuB,CAApD,IAA2DlD,KAAKU,GAAL,CAASkC,QAAQpB,CAAjB,KAAuB,CAAvB,IAA4BxB,KAAKU,GAAL,CAASmC,QAAQK,CAAjB,KAAuB,CAAlH,EACI,IAAKhB,QAAQ,CAAR,IAAaZ,WAAWE,CAAX,EAAc0B,CAAd,KAAoB,GAAlC,IAA2ChB,QAAQ,CAAR,IAAaZ,WAAWE,CAAX,EAAc0B,CAAd,KAAoBtB,QAAQM,OAAO,CAAf,CAAhF,EAAoG;AAChGQ,qCAAIK,MAAJ,IAAcvB,CAAd;AACAmB,qCAAII,MAAJ,IAAcG,CAAd;AACAH;AACH;AACZ;AATL;AAUH,kBAXD,MAWO;AACH,0BAAKvB,IAAIoB,QAAQ,CAAjB,EAAoBpB,IAAIoB,QAAQ,CAAhC,EAAmCpB,GAAnC;AACI,8BAAK0B,IAAIL,QAAQ,CAAjB,EAAoBK,IAAIL,QAAQ,CAAhC,EAAmCK,GAAnC,EAAwC;AACpC,iCAAI1B,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqB0B,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EACI,IAAKhB,QAAQ,CAAR,IAAaZ,WAAWE,CAAX,EAAc0B,CAAd,KAAoB,GAAlC,IAA2ChB,QAAQ,CAAR,IAAaZ,WAAWE,CAAX,EAAc0B,CAAd,KAAoBtB,QAAQM,OAAO,CAAf,CAAhF,EAAoG;AAChGQ,qCAAIK,MAAJ,IAAcvB,CAAd;AACAmB,qCAAII,MAAJ,IAAcG,CAAd;AACAH;AACH;AACR;AARL,sBAjBL,CA0BC;AACA;;;;AAIA;AACArB,qBAAI1B,KAAKC,IAAL,CAAUD,KAAKmD,GAAL,CAAUP,QAAQtE,EAAlB,EAAuB,CAAvB,IAA4B0B,KAAKmD,GAAL,CAAUN,QAAQtE,EAAlB,EAAuB,CAAvB,CAAtC,CAAJ;AACA,qBAAI6E,OAAOpD,KAAKU,GAAL,CAASkC,QAAQtE,EAAjB,IAAuBoD,CAAlC;;AAEA,qBAAI2B,OAAO,CAAX,CAnCD,CAmCe;AACd,qBAAI/E,KAAKsE,KAAL,IAAcrE,KAAKsE,KAAvB,EAA8BQ,OAAOrD,KAAKsD,EAAL,GAAU,CAAV,GAActD,KAAKuD,IAAL,CAAUH,IAAV,CAArB,CAA9B,KACK,IAAIR,SAAStE,EAAT,IAAeC,KAAKsE,KAAxB,EAA+BQ,OAAOrD,KAAKsD,EAAL,GAAU,CAAjB,CAA/B,KACA,IAAIhF,KAAKsE,KAAL,IAAcrE,KAAKsE,KAAvB,EAA8BQ,OAAOrD,KAAKsD,EAAL,GAAU,CAAV,GAActD,KAAKuD,IAAL,CAAUH,IAAV,CAArB,CAA9B,KACA,IAAIP,SAAStE,EAAT,IAAeD,KAAKsE,KAAxB,EAA+BS,OAAOrD,KAAKsD,EAAZ,CAA/B,KACA,IAAIhF,KAAKsE,KAAL,IAAcrE,KAAKsE,KAAvB,EAA8BQ,OAAOrD,KAAKsD,EAAL,GAAUtD,KAAKsD,EAAL,GAAU,CAApB,GAAwBtD,KAAKuD,IAAL,CAAUH,IAAV,CAA/B,CAA9B,KACA,IAAIR,SAAStE,EAAT,IAAeC,KAAKsE,KAAxB,EAA+BQ,OAAOrD,KAAKsD,EAAL,GAAUtD,KAAKsD,EAAL,GAAU,CAA3B,CAA/B,KACA,IAAIhF,KAAKsE,KAAL,IAAcrE,KAAKsE,KAAvB,EAA8BQ,OAAOrD,KAAKsD,EAAL,GAAU,GAAV,GAAgBtD,KAAKuD,IAAL,CAAUH,IAAV,CAAvB;AACnCV,qBAAIjE,IAAJ,CAAS,UAASG,IAAT,EAAeD,KAAf,EAAsB;AAC3B,yBAAII,KAAKH,IAAL,CAAJ,EAAgB;AACZ8C,6BAAI1B,KAAKC,IAAL,CAAUD,KAAKmD,GAAL,CAAUT,IAAI/D,KAAJ,IAAaiE,KAAvB,EAA+B,CAA/B,IAAoC5C,KAAKmD,GAAL,CAAUR,IAAIhE,KAAJ,IAAakE,KAAvB,EAA+B,CAA/B,CAA9C,CAAJ;AACAO,gCAAOpD,KAAKU,GAAL,CAASgC,IAAI/D,KAAJ,IAAaiE,KAAtB,IAA+BlB,CAAtC;;AAEA,6BAAI8B,QAAQ,CAAZ,CAJY,CAIG;AACf,6BAAId,IAAI/D,KAAJ,IAAaiE,KAAb,IAAsBD,IAAIhE,KAAJ,IAAakE,KAAvC,EAA8CW,QAAQxD,KAAKsD,EAAL,GAAU,CAAV,GAActD,KAAKuD,IAAL,CAAUH,IAAV,CAAtB,CAA9C,KACK,IAAIR,SAASF,IAAI/D,KAAJ,CAAT,IAAuBgE,IAAIhE,KAAJ,IAAakE,KAAxC,EAA+CW,QAAQxD,KAAKsD,EAAL,GAAU,CAAlB,CAA/C,KACA,IAAIZ,IAAI/D,KAAJ,IAAaiE,KAAb,IAAsBD,IAAIhE,KAAJ,IAAakE,KAAvC,EAA8CW,QAAQxD,KAAKsD,EAAL,GAAU,CAAV,GAActD,KAAKuD,IAAL,CAAUH,IAAV,CAAtB,CAA9C,KACA,IAAIP,SAASF,IAAIhE,KAAJ,CAAT,IAAuB+D,IAAI/D,KAAJ,IAAaiE,KAAxC,EAA+CY,QAAQxD,KAAKsD,EAAb,CAA/C,KACA,IAAIZ,IAAI/D,KAAJ,IAAaiE,KAAb,IAAsBD,IAAIhE,KAAJ,IAAakE,KAAvC,EAA8CW,QAAQxD,KAAKsD,EAAL,GAAUtD,KAAKsD,EAAL,GAAU,CAApB,GAAwBtD,KAAKuD,IAAL,CAAUH,IAAV,CAAhC,CAA9C,KACA,IAAIR,SAASF,IAAI/D,KAAJ,CAAT,IAAuBgE,IAAIhE,KAAJ,IAAakE,KAAxC,EAA+CW,QAAQxD,KAAKsD,EAAL,GAAUtD,KAAKsD,EAAL,GAAU,CAA5B,CAA/C,KACA,IAAIZ,IAAI/D,KAAJ,IAAaiE,KAAb,IAAsBD,IAAIhE,KAAJ,IAAakE,KAAvC,EAA8CW,QAAQxD,KAAKsD,EAAL,GAAU,GAAV,GAAgBtD,KAAKuD,IAAL,CAAUH,IAAV,CAAxB;AACnD,6BAAIpD,KAAKU,GAAL,CAAS2C,OAAOG,KAAhB,IAAyBP,KAA7B,EAAoC;AAChCA,qCAAQjD,KAAKU,GAAL,CAAS2C,OAAOG,KAAhB,CAAR;AACAT,sCAASpE,KAAT;AACH;AACD,6BAAI6E,SAAS,CAAb,EAAgB;AACZA,qCAAQxD,KAAKsD,EAAL,GAAU,CAAlB;AACA,iCAAItD,KAAKU,GAAL,CAAS2C,OAAOG,KAAhB,IAAyBP,KAA7B,EAAoC;AAChCA,yCAAQjD,KAAKU,GAAL,CAAS2C,OAAOG,KAAhB,CAAR;AACAT,0CAASpE,KAAT;AACH;AACJ;AACJ;AACJ,kBAzBD;;AA2BA4D,wBAAOL,OAAO,CAAd,IAAmBQ,IAAIK,MAAJ,CAAnB;AACAP,wBAAON,OAAO,CAAd,IAAmBS,IAAII,MAAJ,CAAnB;AACAH,yBAAQF,IAAIK,MAAJ,CAAR;AACAF,yBAAQF,IAAII,MAAJ,CAAR;;AAEAb;AACA,qBAAIA,OAAO,CAAX,EAAcc,OAAO,CAAP;AACjB,cA7ED,QA6ESA,QAAQ,CA7EjB;AA8EA,iBAAI7D,OAAO,CAAP,KAAa2C,gBAAgB,GAAhB,IAAuBA,gBAAgB,GAApD,KAA4DS,OAAO,CAAP,KAAa,CAAC,CAA1E,IAA+EC,OAAO,CAAP,KAAa,CAAC,CAAjG,EAAoG;AAChGhB,qBAAI,CAAJ;AACA,qBAAIiC,kBAAkB,KAAtB;AACA,wBAAOlB,OAAOf,CAAP,KAAa,CAAC,CAAd,IAAmBgB,OAAOhB,CAAP,KAAa,CAAC,CAAjC,IAAsC,CAACiC,eAA9C,EAA+D;AAC3D,0BAAK/B,IAAIa,OAAOf,CAAP,CAAT,EAAoBE,IAAIa,OAAOf,CAAP,IAAYrC,IAApC,EAA0CuC,GAA1C;AACI,8BAAKC,IAAIa,OAAOhB,CAAP,CAAT,EAAoBG,IAAIa,OAAOhB,CAAP,IAAYrC,IAApC,EAA0CwC,GAA1C;AACI,iCAAID,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqBC,KAAK,CAA1B,IAA+BA,KAAK,EAAxC,EAA4C;AACxC,qCAAIL,WAAWI,CAAX,EAAcC,CAAd,KAAoB,GAAxB,EAA6B8B,kBAAkB,IAAlB;AAChC;AAHL;AADJ,sBAKAjC;AACH;AACD,qBAAIiC,eAAJ,EAAqB;AACjBhB,kCAAajB,IAAI,CAAjB,IAAsB,GAAtB;AACAe,4BAAOf,CAAP,IAAY,CAAC,CAAb;AACAgB,4BAAOhB,CAAP,IAAY,CAAC,CAAb;AACH;AACJ;;AAED;AACAA,iBAAI,CAAJ;AACA,oBAAOe,OAAOf,CAAP,KAAa,CAAC,CAAd,IAAmBgB,OAAOhB,CAAP,KAAa,CAAC,CAAjC,IAAsCe,OAAOf,CAAP,MAAckC,SAA3D,EAAsE;AACpE1C,sBAAK2C,IAAL,CAAU;AACR,0BAAKpB,OAAOf,CAAP,CADG;AAER,0BAAKgB,OAAOhB,CAAP,CAFG;AAGR,+BAAUiB,aAAajB,CAAb;AAHF,kBAAV;AAKAA;AACD;AACD,oBAAOR,IAAP;AACD;;;;;;;;;;AC/bH;;;;;;;;;;KAEapD,Q,WAAAA,Q;AACX,qBAAYG,EAAZ,EAAgB;AAAA;;AACd,UAAK6F,eAAL,GAAuB7F,EAAvB;AACD;;;;oCAEc;AACb,cAAO2B,gBAAgB,KAAKkE,eAArB,EAAsC,YAAtC,CAAP;AACD;;;+BAES;AACR,WAAIxF,eAAe,KAAKC,YAAL,EAAf,MAAwCqF,SAA5C,EAAuD;AAAE;AACvD,gBAAO,CAAC,CAAR;AACD;AACD,cAAOtF,eAAe,KAAKC,YAAL,EAAf,EAAoC,MAApC,CAAP;AACD;;;;;;;;;;AChBH;;;;;;;;;AAEA;;AACA;;;;KAEaR,W,WAAAA,W;AACX,wBAAYgB,CAAZ,EAAeC,CAAf,EAAkB;AAAA;;AAChB,UAAK+E,aAAL,GAAqBrF,MAAMK,CAAN,EAASC,CAAT,EAAY,KAAZ,CAArB;AACA,aAAON,MAAMK,CAAN,EAASC,CAAT,EAAY,MAAZ,CAAP;AACE,YAAK,MAAL;AACE,cAAKgF,MAAL,GAAc,IAAInG,UAAJ,CAAS,KAAKkG,aAAd,CAAd;AACF;AACA;AACE,cAAKC,MAAL,GAAc,IAAIlG,kBAAJ,CAAa,KAAKiG,aAAlB,CAAd;AACF;AANF;AAQD;;;;oCAEc;AACb,cAAO,KAAKC,MAAL,CAAYzF,YAAZ,EAAP;AACD;;;+BAES;AACR,cAAO,KAAKyF,MAAL,CAAYC,OAAZ,EAAP;AACD","file":"mode.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0e8d5428ca98b09ca17e","\"use strict\"\n\nimport {Unit} from \"./unit.js\";\nimport {Building} from \"./building.js\";\nimport {BoardObject} from \"./board_object.js\";\n\nclass GameMode {\n  constructor() {\n    this.Unit = Unit\n    this.Building = Building\n    this.BoardObject = BoardObject\n  }\n}\n\nwindow.GameMode = new GameMode();\n\n\n// WEBPACK FOOTER //\n// ./game/mode/js/mode.js","\"use strict\"\n\nexport class Unit {\n  constructor(id) {\n    this.boardUnitId = id\n  }\n\n  getSize() {\n    return units[board_units[this.boardUnitId][\"unit_id\"]]['size'].toInt();\n  }\n\n  getMovesLeft() {\n    return board_units[this.boardUnitId][\"moves_left\"].toInt();\n  }\n\n  getPlayerNum() {\n    return board_units[this.boardUnitId]['player_num'];\n  }\n\n  getTeam() {\n    return players_by_num[this.getPlayerNum()]['team'];\n  }\n\n  getLeftUpCoord() {\n    let id = this.boardUnitId;\n    let ux = 9999999;\n    let uy = 9999999;\n    board.each(function(items, index) {\n      if (items) items.each(function(item, index) {\n        if (item)\n          if (item[\"ref\"] == id && item[\"type\"] == \"unit\") {\n            if (item[\"x\"].toInt() < ux) ux = item[\"x\"].toInt();\n            if (item[\"y\"].toInt() < uy) uy = item[\"y\"].toInt();\n          }\n      });\n    });\n    return {x: ux, y: uy}\n  }\n\n  canMove() {\n    let id = this.boardUnitId;\n    return board_units[id][\"moves_left\"].toInt() > 0 && !$chk(board_units[id]['paralich'])\n  }\n\n  isNear(x, y) {\n    let id = this.boardUnitId;\n    var nearSelectedUnit = false;\n    var cx;\n    var cy;\n    for (cx = x - 1; cx < x + 2; cx++)\n      for (cy = y - 1; cy < y + 2; cy++) {\n        if (board[cx])\n          if (board[cx][cy])\n            if (board[cx][cy][\"ref\"] == id && board[cx][cy][\"type\"] == 'unit') {\n              nearSelectedUnit = true;\n            }\n      }\n    return nearSelectedUnit;\n  }\n\n  canTeleport(x, y) {\n    let id = this.boardUnitId;\n    let size = this.getSize();\n    var distance = 999999;\n    var teleport = 0;\n    var tx = 0;\n    var ty = 0;\n    var tid;\n    board_buildings.each(function(item, index) {\n      if (item)\n        if ($chk(players_by_num[item['player_num']])) //player num 9 for trees,moat ... doesnt exists\n          if (board_units[id]['magic_immunity'] != 1 && buildings[item[\"building_id\"]]['ui_code'] == 'teleport' && (item['player_num'] == my_player_num || players_by_num[item['player_num']]['team'] == players_by_num[my_player_num]['team'])) { //this is my Teleport or my ally and unit is not golem(magic_immunity==1)\n            tid = item[\"id\"];\n            teleport = 1;\n            //get coords\n            board.each(function(items, index) {\n              if (items) items.each(function(item, index) {\n                if (item)\n                  if (item[\"ref\"] == tid && item[\"type\"] == \"building\") {\n                    var a = x - item[\"x\"].toInt();\n                    var b = y - item[\"y\"].toInt();\n                    var dist = Math.sqrt(a*a + b*b);\n                    if (dist < distance) { // in case of 2 teleports\n                      distance = dist;\n                      tx = item[\"x\"].toInt();\n                      ty = item[\"y\"].toInt();\n                    }\n                  }\n              });\n            });\n          }\n    });\n    return (x >= tx - size && x <= tx + 1) && (y >= ty - size && y <= ty + 1) && teleport == 1;\n  }\n\n  fitsCoord(x, y) {\n    let mx, my;\n    let id = this.boardUnitId;\n    let size = this.getSize();\n    for (mx = x; mx < x + size; mx++)\n      for (my = y; my < y + size; my++) {\n        if (board[mx])\n          if (board[mx][my])\n            if (board[mx][my][\"ref\"])\n              if (board[mx][my]['type'] != 'unit' || board[mx][my]['ref'] != id) return false;\n        if (mx < 0 || mx > 19 || my < 0 || my > 19) return false;\n      }\n    return true;\n  }\n\n  canFlyToCoord(x, y) {\n    if (!this.fitsCoord(x, y)) {\n      return false;\n    }\n    if (board_units[this.boardUnitId].flying != 1) {\n      return false;\n    }\n\n    // Check flight distance\n    let unitCoord = this.getLeftUpCoord();\n    let movesLeft = this.getMovesLeft();\n    if (Math.abs(unitCoord.x - x) > movesLeft || Math.abs(unitCoord.y - y) > movesLeft) {\n      return false;\n    }\n\n    return true;\n  }\n\n  getMoveCmds(x, y) {\n    // Check Unit can move\n    if (!this.canMove()) {\n      return [];\n    }\n\n    // Teleport Unit\n    if (this.canTeleport(x, y) && this.fitsCoord(x, y)) {\n      return [{\n        'x': x,\n        'y': y,\n        'action': 'm'\n      }];\n    }\n\n    let targetX = x;\n    let targetY = y;\n    //Adjust move coords for big units\n    let ux = this.getLeftUpCoord().x;\n    let uy = this.getLeftUpCoord().y;\n    if (this.isNear(x, y) && this.getSize() > 1) {\n      if (x < ux) {\n        targetX = x;\n      } else if (x > (ux + this.getSize() - 1)) {\n        targetX = x - this.getSize() + 1;\n      } else {\n        targetX = ux;\n      }\n      if (y < uy) {\n        targetY = y;\n      } else if (y > (uy + this.getSize() - 1)) {\n        targetY = y - this.getSize() + 1;\n      } else {\n        targetY = uy;\n      }\n    }\n\n    //Move unit according to path\n    let path = this.getPath(targetX, targetY).slice(0, this.getMovesLeft());\n\n    //Flight if cannot move to coords\n    if (path.length == 0 && this.canFlyToCoord(targetX, targetY)) {\n      return [{\n        'x': targetX,\n        'y': targetY,\n        'action': 'm'\n      }];\n    }\n\n    return path;\n  }\n\n  getPath(x, y) {\n    var path = []\n    var not_reached = true;\n    var path_board = new Array();\n    var i = 0;\n    var k = 0;\n    var l = 0;\n    var m = 0;\n    var symbols = new Array('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'c', 'd', 'e', 'f', 'g', 'h', 'k', 'l', 'm');\n    var id = this.boardUnitId\n    var size = units[board_units[id][\"unit_id\"]]['size'].toInt()\n    var knight = board_units[id][\"knight\"]\n    //init path board\n    for (i = 0; i < 20; i++) {\n        path_board[i] = new Array();\n        for (k = 0; k < 20; k++) {\n            path_board[i][k] = '-';\n        }\n    }\n    //fill path board\n    board.each(function(items, index) {\n        if (items) items.each(function(item, index) {\n            if (item) {\n                if (item['type'] == 'unit' && item['ref'].toInt() == id); //this unit \n                else if (item['type'] == 'obstacle') //cant attack obstacle\n                    path_board[item['x'].toInt()][item['y'].toInt()] = 'x';\n                else if (item['type'] == 'unit') { //attack unit\n                    //fixing bug if we suddenly get not killed unit with not existing player (which already delted)\n                    if (!$chk(players_by_num[board_units[item['ref']]['player_num']])) {\n                        delete board[item['x'].toInt()][item['y'].toInt()];\n                        if ($chk(board_units[item['ref']])) delete board_units[item['ref']];\n                    } else if (board_units[id]['player_num'] == board_units[item['ref']]['player_num'] || players_by_num[board_units[id]['player_num']]['team'] == players_by_num[board_units[item['ref']]['player_num']]['team']) path_board[item['x'].toInt()][item['y'].toInt()] = 'x';\n                    else path_board[item['x'].toInt()][item['y'].toInt()] = 'u';\n                } else { //buildings, castle\n                    if ($chk(players_by_num[board_buildings[item['ref']]['player_num']])) { //player num 9 for trees,moat ... doesnt exists\n                        if (board_units[id]['player_num'] == board_buildings[item['ref']]['player_num'] || players_by_num[board_units[id]['player_num']]['team'] == players_by_num[board_buildings[item['ref']]['player_num']]['team']) path_board[item['x'].toInt()][item['y'].toInt()] = 'x';\n                        else path_board[item['x'].toInt()][item['y'].toInt()] = 'b';\n                    } else\n                    if (board_buildings[item['ref']]['health'] > 0) //can kill bridge\n                        path_board[item['x'].toInt()][item['y'].toInt()] = 'b';\n                    else\n                        path_board[item['x'].toInt()][item['y'].toInt()] = 'x';\n                }\n            }\n        });\n    });\n    var target_coord = path_board[x][y];\n    if (path_board[x][y] != 't') path_board[x][y] = 't';\n    var leftUpCoord = this.getLeftUpCoord();\n    var ux = leftUpCoord.x;\n    var uy = leftUpCoord.y;\n    path_board[ux][uy] = 'z';\n\n    var cnear = false;\n    var tnear = true;\n    var step = 0;\n    var cango = true;\n    var t_in = false;\n    var x_in = false;\n    //start generating all avaible paths\n    while (not_reached && tnear) {\n        tnear = false;\n        for (i = 0; i < 20; i++)\n            for (k = 0; k < 20; k++) {\n                cnear = false;\n                if (path_board[i][k] == '-' || path_board[i][k] == 't') {\n                    if (knight) {\n                        for (l = i - 2; l < i + 3; l++)\n                            for (m = k - 2; m < k + 3; m++) {\n                                if (l >= 0 && l <= 19 && m >= 0 && m <= 19)\n                                    if ((Math.abs(i - l) == 1 && Math.abs(k - m) == 2) || (Math.abs(i - l) == 2 && Math.abs(k - m) == 1))\n                                        if ((step == 0 && path_board[l][m] == 'z') || (step != 0 && path_board[l][m] == symbols[step - 1]))\n                                            if (size > 1) { //large unlts\n                                                if (step == 0 && path_board[l][m] == 'z') {\n                                                    if (l == ux && m == uy) cnear = 1;\n                                                } else cnear = 1;\n                                            } else cnear = 1;\n                            }\n                    } else { //usual moves\n                        for (l = i - 1; l < i + 2; l++)\n                            for (m = k - 1; m < k + 2; m++)\n                                if (l >= 0 && l <= 19 && m >= 0 && m <= 19)\n                                    if ((step == 0 && path_board[l][m] == 'z') || (step != 0 && path_board[l][m] == symbols[step - 1])) cnear = 1;\n                    }\n                    if (cnear) {\n                        if (path_board[i][k] == 't') { //found target unit(s)\n                            not_reached = false;\n                        } else {\n                            cango = true;\n                            if (size > 1) { //large units\n                                t_in = false;\n                                x_in = false;\n                                for (l = i; l < i + size; l++)\n                                    for (m = k; m < k + size; m++) {\n                                        if (l >= 0 && l <= 19 && m >= 0 && m <= 19) {\n                                            if (path_board[l][m] == 'x') x_in = true;\n                                            if (path_board[l][m] == 't') t_in = true;\n                                            if (path_board[l][m] == 'x' || path_board[l][m] == 'u' || path_board[l][m] == 'b') cango = false;\n                                        } else cango = false;\n                                    }\n                                //if can hit target unit by hitting also another b or u - and target not free cell\n                                if (cango == false) {\n                                    if ($chk(board[x]) && $chk(board[x][y]) && $chk(board[x][y]['ref']))\n                                        if (t_in && !x_in) {\n                                            cango = true;\n                                        }\n                                }\n                            }\n                            if (cango) {\n                                path_board[i][k] = symbols[step];\n                                tnear = true;\n                            }\n                        }\n                    }\n                } // =='-'\n            }\n        step++;\n    }\n    //show board\n    // if (x==18 && y==17) for (i=0;i<20;i++)\t{\n    //\tconsole.log(path_board[0][i],path_board[1][i],path_board[2][i],path_board[3][i],path_board[4][i],path_board[5][i],path_board[6][i],path_board[7][i],path_board[8][i],path_board[9][i],path_board[10][i],path_board[11][i],path_board[12][i],path_board[13][i],path_board[14][i],path_board[15][i],path_board[16][i],path_board[17][i],path_board[18][i],path_board[19][i]);\n    //}\n    //generate 1 path\n    step--;\n    path_moves = step + 1;\n    var x_path = []\n    var y_path = []\n    var path_actions = []\n    var u_x = []\n    var u_y = []\n    for (i = 0; i < 40; i++) x_path[i] = -1;\n    for (i = 0; i < 40; i++) y_path[i] = -1;\n    if (target_coord == 'x') return []; //no allias hit\n    for (i = 0; i < 40; i++) path_actions[i] = 'm';\n    var cur_x = x;\n    var cur_y = y;\n    x_path[step] = cur_x;\n    y_path[step] = cur_y;\n    cango = true;\n    var doattack = false;\n    if (size > 1 && target_coord == '-') { //large units\n        for (l = x_path[step]; l < x_path[step] + size; l++)\n            for (m = y_path[step]; m < y_path[step] + size; m++)\n                if (l >= 0 && l <= 19 && m >= 0 && m <= 19) {\n                    if (path_board[l][m] == 'u' || path_board[l][m] == 'b') doattack = true;\n                    if (path_board[l][m] == 'x') cango = false;\n                } else cango = false;\n    } else if (target_coord == 'b' || target_coord == 'u') {\n        doattack = true;\n    }\n    if ((!cango && !doattack)) {\n        x_path[0] = -1;\n        y_path[0] = -1;\n        return [];\n    }\n    if (doattack) path_actions[step] = 'a';\n    cnear = 0;\n    var ufound = 0;\n    var stop = 0;\n    //generate random path to unit\n    do {\n        u_x = new Array();\n        u_y = new Array();\n        ufound = 0;\n        var delta = 100;\n        if (knight == 1) { //knight moves\n            for (i = cur_x - 2; i < cur_x + 3; i++)\n                for (j = cur_y - 2; j < cur_y + 3; j++) {\n                    if (i >= 0 && i <= 19 && j >= 0 && j <= 19)\n                        if ((Math.abs(cur_x - i) == 1 && Math.abs(cur_y - j) == 2) || (Math.abs(cur_x - i) == 2 && Math.abs(cur_y - j) == 1))\n                            if ((step == 0 && path_board[i][j] == 'z') || (step != 0 && path_board[i][j] == symbols[step - 1])) {\n                                u_x[ufound] = i;\n                                u_y[ufound] = j;\n                                ufound++;\n                            }\n                }\n        } else //usual moves\n            for (i = cur_x - 1; i < cur_x + 2; i++)\n                for (j = cur_y - 1; j < cur_y + 2; j++) {\n                    if (i >= 0 && i <= 19 && j >= 0 && j <= 19)\n                        if ((step == 0 && path_board[i][j] == 'z') || (step != 0 && path_board[i][j] == symbols[step - 1])) {\n                            u_x[ufound] = i;\n                            u_y[ufound] = j;\n                            ufound++;\n                        }\n                }\n        //pick random way\n        /*if (ufound!=1)\t{\n\t\t\tufound = Math.floor(Math.random() * ufound);\n\t\t} else ufound--;*/\n\n        //angle path choice\n        l = Math.sqrt(Math.pow((cur_x - ux), 2) + Math.pow((cur_y - uy), 2));\n        var sina = Math.abs(cur_x - ux) / l;\n\n        var angl = 0; // general direction\n        if (ux > cur_x && uy > cur_y) angl = Math.PI / 2 - Math.asin(sina);\n        else if (cur_x == ux && uy > cur_y) angl = Math.PI / 2;\n        else if (ux < cur_x && uy > cur_y) angl = Math.PI / 2 + Math.asin(sina);\n        else if (cur_y == uy && ux < cur_x) angl = Math.PI;\n        else if (ux < cur_x && uy < cur_y) angl = Math.PI + Math.PI / 2 - Math.asin(sina);\n        else if (cur_x == ux && uy < cur_y) angl = Math.PI + Math.PI / 2;\n        else if (ux > cur_x && uy < cur_y) angl = Math.PI * 1.5 + Math.asin(sina);\n        u_x.each(function(item, index) {\n            if ($chk(item)) {\n                l = Math.sqrt(Math.pow((u_x[index] - cur_x), 2) + Math.pow((u_y[index] - cur_y), 2));\n                sina = Math.abs(u_x[index] - cur_x) / l;\n\n                var angl2 = 0; //possible direction\n                if (u_x[index] > cur_x && u_y[index] > cur_y) angl2 = Math.PI / 2 - Math.asin(sina);\n                else if (cur_x == u_x[index] && u_y[index] > cur_y) angl2 = Math.PI / 2;\n                else if (u_x[index] < cur_x && u_y[index] > cur_y) angl2 = Math.PI / 2 + Math.asin(sina);\n                else if (cur_y == u_y[index] && u_x[index] < cur_x) angl2 = Math.PI;\n                else if (u_x[index] < cur_x && u_y[index] < cur_y) angl2 = Math.PI + Math.PI / 2 - Math.asin(sina);\n                else if (cur_x == u_x[index] && u_y[index] < cur_y) angl2 = Math.PI + Math.PI / 2;\n                else if (u_x[index] > cur_x && u_y[index] < cur_y) angl2 = Math.PI * 1.5 + Math.asin(sina);\n                if (Math.abs(angl - angl2) < delta) {\n                    delta = Math.abs(angl - angl2);\n                    ufound = index;\n                }\n                if (angl2 == 0) {\n                    angl2 = Math.PI * 2;\n                    if (Math.abs(angl - angl2) < delta) {\n                        delta = Math.abs(angl - angl2);\n                        ufound = index;\n                    }\n                }\n            }\n        });\n\n        x_path[step - 1] = u_x[ufound];\n        y_path[step - 1] = u_y[ufound];\n        cur_x = u_x[ufound];\n        cur_y = u_y[ufound];\n\n        step--;\n        if (step < 0) stop = 1;\n    } while (stop == 0);\n    if (size > 1 && (target_coord == 'b' || target_coord == 'u') && x_path[0] != -1 && y_path[0] != -1) {\n        i = 0;\n        var can_hit_earlier = false;\n        while (x_path[i] != -1 && y_path[i] != -1 && !can_hit_earlier) {\n            for (l = x_path[i]; l < x_path[i] + size; l++)\n                for (m = y_path[i]; m < y_path[i] + size; m++)\n                    if (l >= 0 && l <= 19 && m >= 0 && m <= 19) {\n                        if (path_board[l][m] == 't') can_hit_earlier = true;\n                    }\n            i++;\n        }\n        if (can_hit_earlier) {\n            path_actions[i - 1] = 'a';\n            x_path[i] = -1;\n            y_path[i] = -1;\n        }\n    }\n\n    // Compile to array of path objects\n    i = 0;\n    while (x_path[i] != -1 && y_path[i] != -1 && x_path[i] !== undefined) {\n      path.push({\n        'x': x_path[i],\n        'y': y_path[i],\n        'action': path_actions[i]\n      })\n      i++\n    }\n    return path\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./game/mode/js/unit.js","\"use strict\"\n\nexport class Building {\n  constructor(id) {\n    this.boardBuildingId = id\n  }\n\n  getPlayerNum() {\n    return board_buildings[this.boardBuildingId]['player_num'];\n  }\n\n  getTeam() {\n    if (players_by_num[this.getPlayerNum()] === undefined) { // no real for obstacles\n      return -1;\n    }\n    return players_by_num[this.getPlayerNum()]['team'];\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./game/mode/js/building.js","\"use strict\"\n\nimport {Unit} from \"./unit.js\";\nimport {Building} from \"./building.js\";\n\nexport class BoardObject {\n  constructor(x, y) {\n    this.boardObjectId = board[x][y]['ref']\n    switch(board[x][y]['type']){\n      case 'unit':\n        this.object = new Unit(this.boardObjectId)\n      break;\n      default:\n        this.object = new Building(this.boardObjectId)\n      break;\n    }\n  }\n\n  getPlayerNum() {\n    return this.object.getPlayerNum();\n  }\n\n  getTeam() {\n    return this.object.getTeam();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./game/mode/js/board_object.js"],"sourceRoot":""}